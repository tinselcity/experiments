# ------------------------------------------------------------------------------
# setup
# ------------------------------------------------------------------------------
CC = gcc
#CC = clang
TIDY = clang-tidy
#CFLAGS = -Werror -Wall -g -O2
CFLAGS = -O0 -ggdb -fsanitize=address
INCLUDES = -I./
LFLAGS = -L./
LIBS = -lm
SRCS = tee_splice.c
OBJS = $(SRCS:.c=.o)
MAIN = tee_splice
# ------------------------------------------------------------------------------
# target: PHONY
# ------------------------------------------------------------------------------
.PHONY: depend clean
# ------------------------------------------------------------------------------
# target: all
# ------------------------------------------------------------------------------
all: $(MAIN)
# ------------------------------------------------------------------------------
# target: MAIN
# ------------------------------------------------------------------------------
$(MAIN): $(OBJS) 
	$(CC) $(CFLAGS) $(INCLUDES) -o $(MAIN) $(OBJS) $(LFLAGS) $(LIBS)
# ------------------------------------------------------------------------------
# build .o
# ------------------------------------------------------------------------------
.c.o:
	$(CC) $(CFLAGS) $(INCLUDES) -c $<  -o $@
# ------------------------------------------------------------------------------
# tidy
# ------------------------------------------------------------------------------
tidy: $(SRCS)
	$(TIDY) $(SRCS) -checks='-*,clang-analyzer-*,-clang-analyzer-security.insecureAPI.*' -- 
# ------------------------------------------------------------------------------
# clean
# ------------------------------------------------------------------------------
clean:
	$(RM) *.o *~ $(MAIN)
# ------------------------------------------------------------------------------
# dependencies
# ------------------------------------------------------------------------------
depend: $(SRCS)
	makedepend $(INCLUDES) $^
